name: macOS Qt Build

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  macos-build:
  runs-on: macos-latest

  steps:
    - name: Checkout Code
      uses: actions/checkout@v3

    - name: Setup Python Virtual Env (safe for macOS)
      run: |
        python3 -m venv venv
        source venv/bin/activate
        pip install --upgrade pip

    - name: Install aqtinstall
      run: |
        source venv/bin/activate
        pip install aqtinstall

    - name: Install Qt
      run: |
        source venv/bin/activate
        aqt install-qt mac desktop 6.5.3 clang_64 --outputdir $HOME/Qt

    - name: Build App
      run: |
        mkdir build
        cd build
        $HOME/Qt/6.5.3/clang_64/bin/qmake ..
        make -j$(sysctl -n hw.ncpu)

    # We will add .app â†’ .dmg packaging later.

